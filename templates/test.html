{% load staticfiles %}
<!DOCTYPE html>
<html>
  <head>
    <title>Queueless haircuts - handsome.ly</title>
    <!-- Bootstrap -->
    <link href="{% static 'css/bootstrap.css' %}" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="{% static 'css/bootstrap-responsive.css' %}" rel="stylesheet">

    <!-- Google Maps API -->
    <script type="text/javascript"
      src="http://maps.googleapis.com/maps/api/js?key=AIzaSyBu3mqa90Iwx2hx4EKpzfUj2kp6y6TC_4Y&amp;sensor=false">
    </script>

    <!--- Creating, loading and customising the map with markers-->
    <script type="text/javascript" src="{% static "js/mapwithmarkers.js"%}"></script>
    <script type="text/javascript" src="{% static "js/infobox.js"%}"></script>
    <link href="{% static 'css/map.css' %}" rel="stylesheet">


  </head>

  <body> 
    <!-- Get the map going -->
    <script type="text/javascript">
      window.onload = function () {
        initialize_map_with_markers('Cambridge', {{ user.is_authenticated|lower }}, {% if user.is_authenticated %} {{ user.id }}{% else %} -1{% endif %});
      }
    </script>


      <div class="navbar navbar-static-top">
        <div class="navbar-inner" style="padding-top: 10px; margin-bottom: 20px;">
        <div class="container-fluid">  
          <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <!-- 3 little horizontal bars -->
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>



          <span class="logo pull-left" style="color:black; font-size:36px; line-height: 40px; font-weight:bold;"><a href="/">handsome.ly</a></span>

          <!-- Everything you want hidden at 940px or less, place within here -->
          <div class="nav-collapse collapse">
          <!-- .nav, .navbar-search, .navbar-form, etc -->
            <ul class="nav nav-tabs pull-right">
              <li class="active">
              <a href="/new_main">For Customers</a>
              </li>
              <li class="disabled">
              <a href="/forsalons">For Salons</a>
              </li>
              <li>
              <a href="/new_about">About Us</a>
              </li>
              <li class="dropdown">
                <a href="/profile" class="dropdown-toggle" data-toggle="dropdown">
                  My Account<b class="caret"></b>
                </a>
                <ul class="dropdown-menu">
                  <li>
                    <a href="/profile">Edit Profile</a>
                  </li>
                  <li class="divider"></li>
                  <li>
                    <a href="/logout">Sign Out</a>
                  </li>
                </ul><!--/dropdownmenu-->
              </li>
            </ul>
          </div><!-- nav collapse -->

        </div> <!--/container-->
      </div>
      </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <p class="lead">Choose your favourite Cambridge haircutterie and get notified by email when they're not busy</p>
      </div>

      <div class="row-fluid" style="height:same-as-width;">
        <div class="span3" style="background-color: #a5bfdd;">
<!--Search box-->
          <form class="form">
            <div class="input-prepend">
              <span class="add-on"><i class="icon-search"></i></span>
              <input type="text"class="prependedInput focusedInput" placeholder="Search for a salon...">
            </div>
          </form>
          <p>[Search not working yet]</p>

          <div id="popupbox"> 
            <form name="login" action="/user_login/" method="POST"> 
            {% csrf_token %}
            <center>Email:</center>
            <center><input type="input" name="email" size="14" /></center>
            <center>Password:</center>
            <center><input type="password" name="password" size="14" />
            <input type="hidden" name="djangoUserID" value="">
            </center>
            <center><input type="submit" name="submit" value="login" /></center>
            </form>
            <center><a href="javascript:login('hide'); javascript:login2('show');">Don't have an account? Sign up here!</a></center> 
            <center><a href="javascript:login('hide');">close</a></center> 
          </div> 
<!--Registration pop up box-->
          <div id="popupbox2"> 
            <form name="register" action="/register/" method="post"> {% csrf_token %}
            <center>Email:</center>
            <center><input type="text" name="email" size="14" /></center>
            <center><input type="submit" name="submit" value="Go!" /></center>
            <center><p>We will send you a confirmation email. No spam we promise!</p></center>
            </form>
            <center><a href="javascript:login2('hide');">close</a></center> 
          </div> 
<!--Sign in pop up box-->
          <div id="popupbox3"> 
            <form name="ajaxLogin" action="" method="POST"> 
            {% csrf_token %}
            <center>Email:</center>
            <center><input type="input" name="email" id="email_ajaxLogin" size="14" /></center>
            <center>Password:</center>
            <center><input type="password" name="password" id="password_ajaxLogin" size="14" />
            <input type="hidden" name="djangoUserID_ajaxLogin" id="djangoUserID_ajaxLogin" value="">
            </center>
            <center><button type="button" name="submit" value="login" onclick="doAjaxLogin();" style="margin-bottom: 10px;"/>login</button></center>
            <center><button type="button" name="ajax_tellUser" id="ajax_tellUser" value="" onclick="ajax_tellU(Ajax_salonID);" style="visibility: hidden;"/>Notify me when this salon is free!</button></center>
            </form>
            <center><a href="javascript:ajax_login('hide'); javascript:login2('show');">Don't have an account? Sign up here!</a></center> 
            <center><a href="javascript:ajax_login('hide');">close</a></center> 
          </div> 
        </div>
<!--Map defined here-->
        <div id="map_canvas" class="span9" style="background-color: #efefef; height:500px">
          <h1 style="text-align:center; color: #999; padding-top:100px;">LOADING MAP</h1>
          <p style="text-align:center; color: #999; padding-left:20%; padding-right:20%;">If you're still able to read this, I hate to break it to you, but the map probably isn't coming :(<br> Give us a slap at team@handomsome.ly and we can try to screw up less in future.</p>
        </div> 
      </div> <!--/maprow-->




      <div class="row-fluid">
        <small class="muted">*Not all salons are currently active on our system.</small> <br>

        <ul class="nav nav-pills pull-right" style="font-size:12px;">
          <li>
            <a href="http://blog.handsome.ly">Blog</a>
          </li>
          <li>
            <a href="/privacy/">Privacy Policy</a>
          </li>
          <li class="disabled">
            <a href="/cookies/">Cookie Policy</a>
          </li>
          <li class="disabled">
            <a>&copy; 2012 handsome.ly</a>
          </li>
        </ul>
      </div>

    </div> <!--/container-->
    <script src="{% static 'js/vendor/jquery-1.8.2.min.js' %}"></script>
    <script src="{% static 'js/vendor/bootstrap.js' %}"></script>
  </body>
</html>



<style type="text/css">
  #popupbox{
  margin: 0; 
  margin-left: 0%; 
  margin-right: 100%;
  margin-top: auto; 
  padding-top: 10px; 
  width: 250px; 
  height: 200px; 
  position: absolute; 
  background: #FBFBF0; 
  border: solid #000000 2px; 
  z-index: 9; 
  font-family: arial; 
  visibility: hidden; 
  }

/*Popup box to allow user to get registrations email */
   #popupbox2{
  margin: 0; 
  margin-left: 0%; 
  margin-right: 100%;
  margin-top: auto; 
  padding-top: 10px; 
  width: 250px; 
  height: 180px; 
  position: absolute; 
  background: #FBFBF0; 
  border: solid #000000 2px; 
  z-index: 9; 
  font-family: arial; 
  visibility: hidden; 
  }

/* Popup box to allow user to login */
  #popupbox3{
  margin: 0; 
  margin-left: 0%; 
  margin-right: 100%;
  margin-top: auto; 
  padding-top: 10px; 
  width: 280px; 
  height:same-as-width;
  position: absolute; 
  background: #FBFBF0; 
  border: solid #000000 2px; 
  z-index: 9; 
  font-family: arial; 
  visibility: hidden; 
  }

.align_right {
    float: right; 
    margin-left: 1em;
    margin-bottom: 1em;
}

  </style>



  <script language="JavaScript" type="text/javascript">
  function login(showhide){
    if(showhide == "show"){
        document.getElementById('popupbox').style.visibility="visible";
    }else if(showhide == "hide"){
        document.getElementById('popupbox').style.visibility="hidden"; 
    }
  }
  
  function ajax_login(showhide){
    if(showhide == "show"){
        document.getElementById('popupbox3').style.visibility="visible";
    }else if(showhide == "hide"){
        document.getElementById('ajax_tellUser').style.visibility="hidden";
        document.getElementById('popupbox3').style.visibility="hidden"; 
    }
  }

  function login2(showhide){
    if(showhide == "show"){
        document.getElementById('popupbox2').style.visibility="visible";
    }else if(showhide == "hide"){
        document.getElementById('popupbox2').style.visibility="hidden"; 
    }
  }

  function getCookie(name) {
    var cookieValue = null;
    if (document.cookie && document.cookie != '') {
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookie = jQuery.trim(cookies[i]);
            // Does this cookie string begin with the name we want?
            if (cookie.substring(0, name.length + 1) == (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}

  function doAjaxLogin(){
    var pass = document.getElementById('password_ajaxLogin').value; 
    var mail = document.getElementById('email_ajaxLogin').value; 
    var csrftoken = getCookie('csrftoken'); 
    jQuery.post('/ajax_user_login/', {email : mail, password: pass, csrfmiddlewaretoken : csrftoken}, function(data){ djangoUserID = data; }); 
    LoggedInStatus = true; 
    document.getElementById('ajax_tellUser').style.visibility="visible";
  }
  
  function ajax_tellU(salID){
    tellUsers(salID);
    document.getElementById('ajax_tellUser').style.visibility="hidden";
    document.getElementById('popupbox3').style.visibility="hidden"; 
  }


  </script>










