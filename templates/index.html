{% extends "base.html" %}   {% block nav-index-active %}active{% endblock %}
{% load staticfiles %}

{% block title %}Haircuts @ Handsome.ly{% endblock %}

  {% block page_specific_headers %}
    <!-- Google Maps API -->
    <script type="text/javascript"
      src="http://maps.googleapis.com/maps/api/js?key=AIzaSyBu3mqa90Iwx2hx4EKpzfUj2kp6y6TC_4Y&amp;sensor=false">
    </script>

    <!--- Creating, loading and customising the map with markers-->
    <script type="text/javascript" src="{% static "js/mapwithmarkers.js"%}"></script>
    <script type="text/javascript" src="{% static "js/infobox.js"%}"></script>
    <link href="{% static 'css/map.css' %}" rel="stylesheet">

    <!--- Popup styling etc -->
    <link href="{% static 'css/main.css' %}" rel="stylesheet">
    <script type="text/javascript" src="{% static "js/main.js"%}"></script>
  {% endblock %}
  
  {% block content %}

     <!-- Get the map going -->
    <script type="text/javascript">
      window.onload = function () {
        initialize_map_with_markers('Cambridge', {{ user.is_authenticated|lower }}, {% if user.is_authenticated %} {{ user.id }}{% else %} -1{% endif %});
      }
    </script>

      <div class="row-fluid">
        <p class="lead">Choose your favourite Cambridge haircutterie and don't miss out on massive savings</p>
      </div>


      <div class="row-fluid" style="height:same-as-width;">

        <div class="span3" style="background-color: ;">
          <form class="form">
            <div class="input-prepend">
              <span class="add-on"><i class="icon-search"></i></span>
              <input type="text" class="prependedInput focusedInput" placeholder="Search not working.">
            </div>
          </form>
          <table class="table table-striped" id="salon_list">
          {% for salon in salonList %}
          	<tr><td>{{ salon.salonName }}</td></tr>
          {% endfor %}
          </table>
        </div>

        <div id="map_canvas" class="span9" style="background-color: #efefef; height:500px">
          <h1 style="text-align:center; color: #999; padding-top:100px;">LOADING MAP</h1>
          <p style="text-align:center; color: #999; padding-left:20%; padding-right:20%;">If you're still able to read this, I hate to break it to you, but the map probably isn't coming :(<br> Give us a slap at team@handomsome.ly and we can try to screw up less in future.</p>
        </div> 
      </div> <!--/maprow-->


          <!-- uggo popups. COMMENT AND IMPROVE ME! -->
          <div id="register-modal" class="modal">
            <div class="modal-header">
              <a href="javascript:register_popup('hide');"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button></a>
              <h3>Register</h3>
            </div> 
            <div class="modal-body">
              <form name="register" action="/register/" method="post">
               {% csrf_token %}
                Email: <input type="text" name="email" />
                <div class="form-actions">
                  <button type="submit" name="submit" class="btn btn-primary pull-right">Register</button>
                  <a href="javascript:register_popup('hide');"><button type="button" class="btn pull-right">Cancel</button></a>
                </div>
                <p>You'll receive a a confirmation email but no spam, never.</p>
              </form>
            </div>
          </div> 

          <!-- POPUPS -->
          <!-- can we name the variables nicely, what is tell user? and is having 'ajax' in there relevant? -->
          <div id="login-modal" class="modal"> 

            <div class="modal-header">
              <a href="javascript:ajax_login('hide');"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button></a>
              <h3>Login</h3>
            </div>

            <div class="modal-body">
              <form name="ajaxLogin" action="" method="POST">
                <div class="row">
                  {% csrf_token %}
                  <span class="pull-right">Email: <input type="text" name="email" id="email_ajaxLogin"/></span><br>
                </div>

                <div class="row">
                  <span class="pull-right">Password: <input type="password" name="password" id="password_ajaxLogin" /></span>
                </div>
                <input type="hidden" name="djangoUserID_ajaxLogin" id="djangoUserID_ajaxLogin" value="">

                <div class="form-actions">
                  <button type="button" class="btn btn-primary pull-right" name="login" value="login" onclick="doAjaxLogin();">Log in</button>
                  <a href="javascript:ajax_login('hide');"><button type="button" class="btn pull-right">Cancel</button></a>
                  <a href="javascript:ajax_login('hide'); javascript:register_popup('show');" class="btn btn-link pull-right">Register for an account</a>
                </div>

                <button class="btn btn-primary btn-block" type="button" name="ajax_tellUser" id="ajax_tellUser" value="" onclick="ajax_tellU(Ajax_salonID);" style="visibility: hidden;">Email me when this salon is free</button>
              </form>
            </div>
        </div> 

      <div class="row-fluid">
        <small class="muted">*Not all salons are currently active on our system.</small> <br>
      </div>



  {% endblock %}
